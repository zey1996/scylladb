

<!DOCTYPE html>
<html class="no-js" lang="en" style="visibility: hidden;">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Encryption at Rest | ScyllaDB Docs 
        </title>
        <meta name="description" content="ScyllaDB is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../../_static/img/favicon-228x228.png" />

        
            
            
        

        
            <link rel="canonical" href="https://opensource.docs.scylladb.com/operating-scylla/security/encryption-at-rest.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                  href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>
        
            
                <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../_static/css/main.css?v=9446d426" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../_static/sphinx_collapse.css?v=226d88b4" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=1a953dd0" />
            
        
    
        
        
            
        <script type="text/javascript" src="../../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../../_static/js/main.bundle.js"></script>
        
            
                <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
            
        
            
                <script src="../../_static/doctools.js?v=9a2dae69"></script>
            
        
            
                <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
            
        
            
                <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
            
        
            
                <script src="../../_static/copybutton.js?v=f281be69"></script>
            
        
            
                <script src="../../_static/tabs.js?v=3030b3cb"></script>
            
        
    
            
                <!-- Local meta tags -->
            
            
                <!-- Google Tag Manager docs -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-54NWVS4");
</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager global -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
            
        
    </head>

    <body class="brand-open-source">
        <section class="promo-banner  promo-banner--hide" style="display: none;">
    <div class="promo-banner-wrapper">
        
        <div class="promo-banner__title">ScyllaDB University LIVE, FREE Virtual Training Event | March 21</div>
        <a class="promo-banner__button button button--reverse" href="https://lp.scylladb.com/university-live-2023-03-registration?siteplacement=docs"
           target="_blank" rel="noopener noreferrer">Register for Free</a>
        <button class="promo-banner__close">
            <i class="icon-cancel"></i>
        </button>
    </div>
</section>
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../../_static/img/scylladb-logo-horizontal.svg" alt="ScyllaDB Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Server
                    <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://opensource.docs.scylladb.com/">
                            <i class="icon-docs-open-source"></i>
                            ScyllaDB Open Source
                        </a>
                    </li>
                    <li>
                        <a href="https://enterprise.docs.scylladb.com/">
                            <i class="icon-docs-enterprise"></i>ScyllaDB Enterprise
                        </a>
                    </li>
                    <li>
                        <a href="https://scylla.docs.scylladb.com/stable/alternator/alternator.html">
                            <i class="icon-docs-alternator"></i>
                            ScyllaDB Alternator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="https://docs.scylladb.com/scylla-cloud/" class="scylla-dropdown__title">Cloud</a>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="icon-docs-manager"></i>ScyllaDB Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="icon-docs-monitoring"></i>ScyllaDB
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="icon-docs-operator"></i>ScyllaDB Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/cql-drivers/">
                            <i class="icon-docs-nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/using-scylla/drivers/dynamo-drivers/">
                            <i class="icon-docs-alternator"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://www.scylladb.com/download/" class="button"><i class="icon-download me-2"></i> Download</a>
        </div>
    </div>
    <div class="header-search-box">
        <i class="dark-theme-toggler icon-theme"></i>
        <div class="search-box">
            <ci-search></ci-search>
        </div>
    </div>
    <div class="side-nav-toggle">
    <i class="dark-theme-toggler icon-theme"></i>
    <div class="side-nav-toggle__button" data-toggle="side-nav">
        <i class="icon-menu"></i>
    </div>
</div>
</header>
        <div class="title"></div>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://docs.scylladb.com"
           class="bread__highlight">
            <i class="icon-home"></i> ScyllaDB Docs
        </a>
    </span>
    <span class="bread__item">
        <a href="../../index.html"
           class="bread__highlight">
            ScyllaDB Open Source
        </a>
    </span>
    
        <span class="bread__item">
            <a href="../index.html" class="bread__highlight">
                ScyllaDB for Administrators
            </a>
        </span>
    
        <span class="bread__item">
            <a href="index.html" class="bread__highlight">
                Security
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Encryption at Rest</span>
</div>
                    </div>
                
                
                <div class="sidebar-right-layout">
                    <div class="body-container">
                

                    <div class="content-body">
                        
                            
                        
                        
                        <section id="encryption-at-rest">
<h1>Encryption at Rest<a class="headerlink" href="#encryption-at-rest" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>ScyllaDB protects your sensitive data with data-at-rest encryption.
It protects the privacy of your user’s data, reduces the risk of data breaches, and helps meet regulatory requirements.
In particular, it provides an additional level of protection for your data persisted in storage or its backups.</p>
<p>When ScyllaDB’s Encryption at Rest is used together with Encryption in Transit (<a class="reference internal" href="node-node-encryption.html"><span class="doc">Node to Node</span></a>  and <a class="reference internal" href="client-node-encryption.html"><span class="doc">Client to Node</span></a>), you benefit from end to end data encryption.</p>
</section>
<section id="about-encryption-at-rest">
<h2>About Encryption at Rest<a class="headerlink" href="#about-encryption-at-rest" title="Link to this heading">¶</a></h2>
<p>The following can be encrypted:</p>
<ul class="simple">
<li><p>ScyllaDB persistent tables (SSTables)</p></li>
<li><p>System level data, such as:</p>
<ul>
<li><p>Commit logs</p></li>
<li><p>Batches</p></li>
<li><p>hints logs</p></li>
<li><p>KMIP Password (part of scylla.yaml)</p></li>
</ul>
</li>
</ul>
<p>Encryption at Rest works at table level granularity, so you can choose to encrypt only sensitive tables. For both system and table data, you can use different algorithms that are supported by <a class="reference external" href="https://www.openssl.org/">OpenSSL</a> in a file block encryption scheme.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SSTables of a particular table can have different encryption keys, use different encryption algorithms, or not be encrypted at all - at the same time.</p>
</div>
<section id="when-is-data-encrypted">
<h3>When is Data Encrypted?<a class="headerlink" href="#when-is-data-encrypted" title="Link to this heading">¶</a></h3>
<p>As SSTables are immutable, tables are encrypted only once, as a result of memtable flush, compaction, or upgrade (with <a class="reference internal" href="../nodetool-commands/upgradesstables.html"><span class="doc">Nodetool upgradesstables</span></a>).</p>
<p>Once a table is encrypted, all resulting SSTables are encrypted using the most current key and algorithm.
When you encrypt an existing table, the new SSTables are encrypted. The old SSTables which existed before the encryption are not updated. These tables are encrypted according to the same actions as described previously.</p>
</section>
<section id="when-is-data-decrypted">
<h3>When is Data Decrypted?<a class="headerlink" href="#when-is-data-decrypted" title="Link to this heading">¶</a></h3>
<p>When ScyllaDB reads an encrypted SSTable from disk, it fetches the encryption key’s ID from the SSTable and uses it to extract the key and decrypt the data.
When ScyllaDB reads an encrypted system table, it fetches the system table encryption key location from the scylla.yaml file. It locates the key and uses it to extract the key and decrypt the data.</p>
</section>
</section>
<section id="encryption-key-types">
<h2>Encryption Key Types<a class="headerlink" href="#encryption-key-types" title="Link to this heading">¶</a></h2>
<p>Two types of encryption keys are available: System Keys and Table Keys.</p>
<section id="system-keys">
<h3>System Keys<a class="headerlink" href="#system-keys" title="Link to this heading">¶</a></h3>
<p>System keys are used for encrypting system data, such as commit logs, hints, and/or other user table keys. When a Replicated Key Provider is used for encrypting SSTables, the table keys are stored in the encrypted_keys table, and the system key is used to encrypt the encrypted_keys table. The system key is stored as the contents of a local file and is encrypted with a single key that you provide. The default location of system keys is <code class="docutils literal notranslate"><span class="pre">/etc/scylla/resources/system_keys/</span></code> and can be changed with the <code class="docutils literal notranslate"><span class="pre">system_key_directory</span></code> option in scylla.yaml file. When a Local Key Provider is used for encrypting system info, you can provide your own key, or ScyllaDB can make one for you.</p>
</section>
<section id="table-keys">
<span id="replicated"></span><h3>Table Keys<a class="headerlink" href="#table-keys" title="Link to this heading">¶</a></h3>
<p>Table keys are used for encrypting SSTables. Depending on your key provider, this key is stored in different locations:</p>
<ul class="simple">
<li><p>Replicated Key Provider - encrypted_keys table</p></li>
<li><p>KMIP Key Provider - KMIP server</p></li>
<li><p>KMS Key Provider - AWS</p></li>
<li><p>Local Key Provider - in a local file with multiple keys. You can provide your own key or ScyllaDB can make one for you.</p></li>
</ul>
<div class="admonition note" id="ear-key-providers">
<p class="admonition-title">Note</p>
<p>Encrypted SStables undergo a regular backup procedure. Ensure you keep your
encryption key available in case you need to restore from backup.</p>
</div>
</section>
</section>
<section id="key-providers">
<h2>Key Providers<a class="headerlink" href="#key-providers" title="Link to this heading">¶</a></h2>
<p>When encrypting the system tables or SSTables, you need to state which provider is holding your keys. You can use the following options:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 33.3%" />
<col style="width: 33.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Key Provider Name</p></th>
<th class="head"><p>key_provider Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Local Key Provider</p></td>
<td><p>LocalFileSystemKeyProviderFactory (<strong>default</strong>)</p></td>
<td><p>Stores the key on the same machine as the data.</p></td>
</tr>
<tr class="row-odd"><td><p>Replicated Key Provider</p></td>
<td><p>ReplicatedKeyProviderFactory</p></td>
<td><p>Stores table keys in a ScyllaDB table where the table itself is encrypted using the system key (available from 2019.1.3)</p></td>
</tr>
<tr class="row-even"><td><p>KMIP Key Provider</p></td>
<td><p>KmipKeyProviderFactory</p></td>
<td><p>External key management server (available from 2019.1.3)</p></td>
</tr>
<tr class="row-odd"><td><p>KMS Key Provider</p></td>
<td><p>KmsKeyProviderFactory</p></td>
<td><p>Uses key(s) provided by the AWS KMS service.</p></td>
</tr>
<tr class="row-even"><td><p>GCP Key Provider</p></td>
<td><p>GcpKeyProviderFactory</p></td>
<td><p>Used key(s) provided by the GCP KMS service.</p></td>
</tr>
</tbody>
</table>
<section id="about-local-key-storage">
<h3>About Local Key Storage<a class="headerlink" href="#about-local-key-storage" title="Link to this heading">¶</a></h3>
<p>Local keys are used for encrypting user data, such as SSTables.
Currently, this is the only option  available for user data and, as such, is the default key storage manager.
With local key storage, keys are stored locally on disk in a text file. The location of this file is specified in the scylla.yaml.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Care should be taken so that no unauthorized person can access the key data from the file system. Make sure that the owner of this file is the <code class="docutils literal notranslate"><span class="pre">scylla</span></code> user and that the file is <strong>not</strong> readable by <strong>other users</strong>, not accessible by <strong>other roles</strong>.</p>
</div>
<p>You should also consider keeping the key directory on a network drive (using TLS for the file sharing) to avoid having keys and data on the same storage media, in case your storage is stolen or discarded.</p>
</section>
</section>
<section id="cipher-algorithms">
<span id="ear-cipher-algorithms"></span><h2>Cipher Algorithms<a class="headerlink" href="#cipher-algorithms" title="Link to this heading">¶</a></h2>
<p>The following cipher_algorithims are available for use with ScyllaDB using <a class="reference external" href="https://www.openssl.org/">OpenSSL</a>. Note that the default algorithm (AES/CBC/PKCS5Padding with key strength 128 ) is recommended.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 70.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>cipher_algorithm</p></th>
<th class="head"><p>secret_key_strength</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES/CBC/PKCS5Padding (<strong>default</strong>)</p></td>
<td><p>128 (<strong>default</strong>), 192, or 256</p></td>
</tr>
<tr class="row-odd"><td><p>AES/ECB/PKCS5Padding</p></td>
<td><p>128, 192, or 256</p></td>
</tr>
<tr class="row-even"><td><p>Blowfish/CBC/PKCS5Padding</p></td>
<td><p>32-448</p></td>
</tr>
</tbody>
</table>
</section>
<section id="create-encryption-keys">
<span id="ear-create-encryption-key"></span><h2>Create Encryption Keys<a class="headerlink" href="#create-encryption-keys" title="Link to this heading">¶</a></h2>
<p>Depending on your key provider, you will either have the option of allowing ScyllaDB to generate an encryption key, or you will have to provide one:</p>
<ul class="simple">
<li><p>KMIP Key Provider - you don’t need to generate any key yourself</p></li>
<li><p>KMS Key Provider - you must generate a key yourself in AWS</p></li>
<li><p>Replicated Key Provider - you must generate a system key yourself</p></li>
<li><p>Local Key Provider - If you do not generate your own secret key, ScyllaDB will create one for you</p></li>
</ul>
<section id="use-the-key-generator-script">
<h3>Use the key generator script<a class="headerlink" href="#use-the-key-generator-script" title="Link to this heading">¶</a></h3>
<p>The Key Generator script generates a key in the directory of your choice.</p>
<p><strong>Procedure</strong></p>
<ol class="arabic">
<li><p>Create (if it doesn’t exist) a local directory for storing the key.  Make sure that the owner of the directory is <code class="docutils literal notranslate"><span class="pre">scylla</span></code> and not another user. Make sure that the <code class="docutils literal notranslate"><span class="pre">scylla</span></code> user can read, write, and execute over the parent directory. Following this procedure makes <code class="docutils literal notranslate"><span class="pre">/etc/scylla/encryption_keys/</span></code> the parent directory of your keys.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo mkdir -p /etc/scylla/encryption_keys/system_keys
sudo chown -R scylla:scylla /etc/scylla/encryption_keys
sudo chmod -R 700 /etc/scylla/encryption_keys
</pre></div>
</div>
</li>
<li><p>Create a key using the local file key generator script making sure that the keyfile owner is <code class="docutils literal notranslate"><span class="pre">scylla</span></code> and not another user. Run the command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo -u scylla /usr/bin/scylla local-file-key-generator &lt;op&gt; [options] [key-path]
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-a,--alg</span> <span class="pre">&lt;arg&gt;</span></code> - the encryption algorithm (e.g., AES) you want to use to encrypt the key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-h,--help</span></code> - displays the help menu</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-l,--length</span> <span class="pre">&lt;arg&gt;</span></code> - the length of the encryption key in bits (i.e. 128, 256)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-b,--block-mode</span> <span class="pre">&lt;arg&gt;</span></code> - the encryption algorithm block mode (i.e. CBC, EBC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p,--padding</span> <span class="pre">&lt;arg&gt;</span></code> - the encryption algorithm padding method (i.e. PKCS5)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key-path</span></code> - is the directory you want to place the key into (/etc/scylla/encryption_keys, for example)</p></li>
</ul>
<p>And <code class="docutils literal notranslate"><span class="pre">&lt;op&gt;</span></code> is one of <code class="docutils literal notranslate"><span class="pre">generate</span></code> or <code class="docutils literal notranslate"><span class="pre">append</span></code>, the first creating a new key file with the generated key, the latter
appending a new key of the required type to an existing file.</p>
<p>For Example:</p>
<p>To create a secret key and a system key using other encryption settings in a different location:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo -u scylla /usr/bin/scylla local-file-key-generator generate -a AES -b ECB -p PKCS5 -l 192 /etc/scylla/encryption_keys/secret_key
sudo -u scylla /usr/bin/scylla local-file-key-generator generate -a AES -b CBC -p PKCS5 -l 128 /etc/scylla/encryption_keys/system_keys/system_key
</pre></div>
</div>
<p>To display the secret key parameters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo cat /etc/scylla/encryption_keys/secret_key
</pre></div>
</div>
<p>Returns:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>AES/ECB/PKCS5Padding:192:8stVxW5ypYhNxsnRVS1A6suKhk0sG4Tj
</pre></div>
</div>
<p>To display the system key parameters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo cat /etc/scylla/encryption_keys/system_keys/system_key
</pre></div>
</div>
<p>Returns:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>AES/CBC/PKCS5Padding:128:GGpOSxTGhtPRPLrNPYvVMQ==
</pre></div>
</div>
<p>Once you have created a key, copy the key to each node, using the procedure described in <a class="reference internal" href="#copy-keys-to-nodes">Copy keys to nodes</a>.</p>
</li>
</ol>
</section>
<section id="copy-keys-to-nodes">
<h3>Copy keys to nodes<a class="headerlink" href="#copy-keys-to-nodes" title="Link to this heading">¶</a></h3>
<p>Every key you generate needs to be copied to the nodes for use in local key providers.</p>
<p><strong>Procedure</strong></p>
<ol class="arabic simple">
<li><p>Securely copy the key file, using <code class="docutils literal notranslate"><span class="pre">scp</span></code> or similar, to the same path on all nodes in the cluster. Make sure the key on each target node is moved to the same location as the source directory and that the target directory has the same permissions as the source directory.</p></li>
<li><p>Repeat for all nodes in the cluster.</p></li>
</ol>
</section>
</section>
<section id="set-the-kmip-host">
<span id="encryption-at-rest-set-kmip"></span><h2>Set the KMIP Host<a class="headerlink" href="#set-the-kmip-host" title="Link to this heading">¶</a></h2>
<p>If you are using <a class="reference internal" href="../../reference/glossary.html#term-Key-Management-Interoperability-Protocol-KMIP"><span class="xref std std-term">KMIP</span></a> to encrypt tables or system information, add the KMIP server information to the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> configuration file.</p>
<ol class="arabic">
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file located in <code class="docutils literal notranslate"><span class="pre">/etc/scylla/</span></code> and add the following in KMIP host(s) section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># kmip_hosts:</span>
<span class="c1">#   &lt;name&gt;:</span>
<span class="c1">#       hosts: &lt;address1[:port]&gt; [, &lt;address2[:port]&gt;...]</span>
<span class="c1">#       certificate: &lt;identifying certificate&gt; (optional)</span>
<span class="c1">#       keyfile: &lt;identifying key&gt; (optional; it is required if &quot;certificate&quot; is set)</span>
<span class="c1">#       truststore: &lt;truststore for SSL connection&gt; (optional)</span>
<span class="c1">#       certficate_revocation_list: &lt;CRL file&gt; (optional)</span>
<span class="c1">#       priority_string: &lt;kmip tls priority string&gt;</span>
<span class="c1">#       username: &lt;login&gt; (optional&gt;</span>
<span class="c1">#       password: &lt;password&gt; (optional)</span>
<span class="c1">#       max_command_retries: &lt;int&gt; (optional; default 3)</span>
<span class="c1">#       key_cache_expiry: &lt;key cache expiry period&gt;</span>
<span class="c1">#       key_cache_refresh: &lt;key cache refresh/prune period&gt;</span>
<span class="c1">#   &lt;name&gt;:</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> - The cluster name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hosts</span></code> - The list of hosts specified by IP and port for the KMIP server. The KMIP connection management only supports failover, so all requests go through a single KMIP server. There is no load balancing, as currently no KMIP servers support read replication or other strategies for availability. Hosts are tried in the order they appear, and the next one in the list is tried if the previous one fails. The default number of retries is three, but you can customize it with “max_command_retries”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> - The name of the certificate and path used to identify yourself to the KMIP server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyfile</span></code> - The name of the key used to identify yourself to the KMIP server. It is generated together with the certificate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truststore</span></code> - The location and key for the truststore to present to the KMIP server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certficate_revocation_list</span></code> - The path to a PEM-encoded certificate revocation list (CRL) - a list of issued certificates that have been revoked before their expiration date.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priority_string</span></code> - The KMIP TLS priority string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">username</span></code> - The KMIP server user name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">password</span></code> - The KMIP server password.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_command_retries</span></code> - The number of attempts to connect to the KMIP server before trying the next host in the list.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_cache_expiry</span></code> - Key cache expiry period, after which keys will be re-requested from server. Default is 600s.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_cache_refresh</span></code> - Key cache refresh period - the frequency at which cache is checked for expired entries. Default is 1200s.</p></li>
</ul>
</li>
<li><p>Save the file.</p></li>
<li><p>Drain the node with <a class="reference internal" href="../nodetool-commands/drain.html"><span class="doc">nodetool drain</span></a></p></li>
<li><p>Restart the scylla-server service.</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U3VwcG9ydGVkIE9T" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tab" tabindex="0">Supported OS</button><button aria-controls="panel-0-RG9ja2Vy" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-RG9ja2Vy" name="RG9ja2Vy" role="tab" tabindex="-1">Docker</button></div><div aria-labelledby="tab-0-U3VwcG9ydGVkIE9T" class="sphinx-tabs-panel group-tab" id="panel-0-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>scylla-server
</pre></div>
</div>
</div><div aria-labelledby="tab-0-RG9ja2Vy" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-RG9ja2Vy" name="RG9ja2Vy" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>some-scylla<span class="w"> </span>supervisorctl<span class="w"> </span>restart<span class="w"> </span>scylla
</pre></div>
</div>
<p>(without restarting <em>some-scylla</em> container)</p>
</div></div>
</section>
<section id="set-the-kms-host">
<span id="encryption-at-rest-set-kms"></span><h2>Set the KMS Host<a class="headerlink" href="#set-the-kms-host" title="Link to this heading">¶</a></h2>
<p>If you are using AWS KMS to encrypt tables or system information, add the KMS information to the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> configuration file.</p>
<ol class="arabic">
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file located in <code class="docutils literal notranslate"><span class="pre">/etc/scylla/</span></code> to add the following in KMS host(s) section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">kms_hosts</span><span class="p">:</span>
<span class="w">   </span><span class="nt">&lt;name&gt;</span><span class="p">:</span>
<span class="w">       </span><span class="nt">endpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http(s)://&lt;host&gt;(:port) (optional if `aws_region` is specified)</span>
<span class="w">       </span><span class="nt">aws_region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;aws region&gt; (optional if `endpoint` is specified)</span>
<span class="w">       </span><span class="nt">aws_access_key_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;aws access key id&gt; (optional)</span>
<span class="w">       </span><span class="nt">aws_secret_access_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;aws secret access key&gt; (optional)</span>
<span class="w">       </span><span class="nt">aws_profile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;aws credentials profile to use&gt; (optional)</span>
<span class="w">       </span><span class="nt">aws_use_ec2_credentials: (bool </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default false)</span>
<span class="w">       </span><span class="nt">aws_use_ec2_region: (bool </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default false)</span>
<span class="w">       </span><span class="nt">aws_assume_role_arn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;arn of aws role to assume before call&gt; (optional)</span>
<span class="w">       </span><span class="nt">master_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;named KMS key for encrypting data keys&gt; (required)</span>
<span class="w">       </span><span class="nt">certificate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;identifying certificate&gt; (optional)</span>
<span class="w">       </span><span class="nt">keyfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;identifying key&gt; (optional)</span>
<span class="w">       </span><span class="nt">truststore</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;truststore for SSL connection&gt; (optional)</span>
<span class="w">       </span><span class="nt">priority_string</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;KMS TLS priority string&gt; (optional)</span>
<span class="w">       </span><span class="nt">key_cache_expiry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;key cache expiry period&gt;</span>
<span class="w">       </span><span class="nt">key_cache_refresh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;key cache refresh/prune period&gt;</span>
<span class="c1">#   &lt;name&gt;:</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> - The name to identify the KMS host. You have to provide this name to encrypt a <a class="reference internal" href="#ear-create-table"><span class="std std-ref">new</span></a> or <a class="reference internal" href="#ear-alter-table"><span class="std std-ref">existing</span></a> table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endpoint</span></code> - The explicit KMS host endpoint. If not provided, <code class="docutils literal notranslate"><span class="pre">aws_region</span></code> is used for connection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_region</span></code> - An AWS region. If not provided, <code class="docutils literal notranslate"><span class="pre">endpoint</span></code> is used for connection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_access_key_id</span></code> - AWS access key used for authentication. If not specified, the provider reads it from your AWS credentials.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_secret_access_key</span></code> - AWS secret access key used for authentication. If not specified, the provider reads it from your AWS credentials.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_profile</span></code> - AWS profile to use if reading credentials from file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_use_ec2_credentials</span></code> - If true, KMS queries will use the credentials provided by ec2 instance role metadata as initial access key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_use_ec2_region</span></code> - If true, KMS queries will use the AWS region indicated by ec2 instance metadata.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aws_assume_role_arn</span></code> - If set, any KMS query will first attempt to assume this role.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">master_key</span></code> - The ID or alias of your AWS KMS key. The key must be generated with an appropriate access policy so that the AWS user has permissions to read the key and encrypt data using that key. This parameter is required.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> - The name of the certificate and the path used to identify yourself to the KMS server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyfile</span></code> - The name of the key for the certificate. It is generated together with the certificate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truststore</span></code> - The location and key for the truststore to present to the KMS server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priority_string</span></code> - The KMS TLS priority string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_cache_expiry</span></code> - Key cache expiry period, after which keys will be re-requested from server. Default is 600s.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_cache_refresh</span></code> - Key cache refresh period - the frequency at which cache is checked for expired entries. Default is 1200s.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that either <code class="docutils literal notranslate"><span class="pre">endpoint</span></code>, <code class="docutils literal notranslate"><span class="pre">aws_region</span></code> or <code class="docutils literal notranslate"><span class="pre">aws_use_ec2_region</span></code> must be set (one of them is required for connection).</p>
</div>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">kms_hosts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my-kms1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">aws_use_ec2_credentials</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">aws_use_ec2_region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">master_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myorg/MyKey</span>
</pre></div>
</div>
</li>
<li><p>Save the file.</p></li>
<li><p>Drain the node with <a class="reference internal" href="../nodetool-commands/drain.html"><span class="doc">nodetool drain</span></a></p></li>
<li><p>Restart the scylla-server service.</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U3VwcG9ydGVkIE9T" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tab" tabindex="0">Supported OS</button><button aria-controls="panel-1-RG9ja2Vy" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-RG9ja2Vy" name="RG9ja2Vy" role="tab" tabindex="-1">Docker</button></div><div aria-labelledby="tab-1-U3VwcG9ydGVkIE9T" class="sphinx-tabs-panel group-tab" id="panel-1-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>scylla-server
</pre></div>
</div>
</div><div aria-labelledby="tab-1-RG9ja2Vy" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-RG9ja2Vy" name="RG9ja2Vy" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>some-scylla<span class="w"> </span>supervisorctl<span class="w"> </span>restart<span class="w"> </span>scylla
</pre></div>
</div>
<p>(without restarting <em>some-scylla</em> container)</p>
</div></div>
</section>
<section id="set-the-gcp-host">
<span id="encryption-at-rest-set-gcp"></span><h2>Set the GCP Host<a class="headerlink" href="#set-the-gcp-host" title="Link to this heading">¶</a></h2>
<p>If you are using Google GCP KMS to encrypt tables or system information, add the GCP information to the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> configuration file.</p>
<ol class="arabic">
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file located in <code class="docutils literal notranslate"><span class="pre">/etc/scylla/</span></code> to add the following in KMS host(s) section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nt">gcp_hosts</span><span class="p">:</span>
<span class="w">   </span><span class="nt">&lt;name&gt;</span><span class="p">:</span>
<span class="w">       </span><span class="nt">gcp_project_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;gcp project&gt;</span>
<span class="w">       </span><span class="nt">gcp_location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;gcp location&gt;</span>
<span class="w">       </span><span class="nt">gcp_credentials_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;(service) account json key file - authentication&gt;</span>
<span class="w">       </span><span class="nt">gcp_impersonate_service_account</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;service account to impersonate&gt;</span>
<span class="w">       </span><span class="nt">master_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;keyring&gt;/&lt;keyname&gt; - named GCP key for encrypting data keys (required)</span>
<span class="w">       </span><span class="nt">certificate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;identifying certificate&gt; (optional)</span>
<span class="w">       </span><span class="nt">keyfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;identifying key&gt; (optional)</span>
<span class="w">       </span><span class="nt">truststore</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;truststore for SSL connection&gt; (optional)</span>
<span class="w">       </span><span class="nt">priority_string</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;KMS TLS priority string&gt; (optional)</span>
<span class="w">       </span><span class="nt">key_cache_expiry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;key cache expiry period&gt;</span>
<span class="w">       </span><span class="nt">key_cache_refresh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;key cache refresh/prune period&gt;</span>
<span class="c1">#   &lt;name&gt;:</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> - The name to identify the GCP host. You have to provide this name to encrypt a <a class="reference internal" href="#ear-create-table"><span class="std std-ref">new</span></a> or <a class="reference internal" href="#ear-alter-table"><span class="std std-ref">existing</span></a> table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcp_project_id</span></code> - The GCP project from which to retrieve key information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcp_location</span></code> - A GCP project location.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcp_credentials_file</span></code> - GCP credentials file used for authentication. If not specified, the provider reads it from your GCP credentials.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcp_impersonate_service_account</span></code> - An optional service account to impersonate when issuing key query calls.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">master_key</span></code> - The &lt;keyring&gt;/&lt;keyname&gt; of your GCP KMS key. The key must be generated with an appropriate access policy so that the AWS user has permissions to read the key and encrypt data using that key. This parameter is required.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> - The name of the certificate and the path used to identify yourself to the KMS server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keyfile</span></code> - The name of the key for the certificate. It is generated together with the certificate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">truststore</span></code> - The location and key for the truststore to present to the KMS server.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">priority_string</span></code> - The KMS TLS priority string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_cache_expiry</span></code> - Key cache expiry period, after which keys will be re-requested from server. Default is 600s.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_cache_refresh</span></code> - Key cache refresh period - the frequency at which cache is checked for expired entries. Default is 1200s.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">gcp_hosts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">my-gcp1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">gcp_project_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myproject</span>
<span class="w">      </span><span class="nt">gcp_location</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">master_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mykeyring/mykey</span>
</pre></div>
</div>
</li>
<li><p>Save the file.</p></li>
<li><p>Drain the node with <a class="reference internal" href="../nodetool-commands/drain.html"><span class="doc">nodetool drain</span></a></p></li>
<li><p>Restart the scylla-server service.</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-U3VwcG9ydGVkIE9T" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tab" tabindex="0">Supported OS</button><button aria-controls="panel-2-RG9ja2Vy" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-RG9ja2Vy" name="RG9ja2Vy" role="tab" tabindex="-1">Docker</button></div><div aria-labelledby="tab-2-U3VwcG9ydGVkIE9T" class="sphinx-tabs-panel group-tab" id="panel-2-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>scylla-server
</pre></div>
</div>
</div><div aria-labelledby="tab-2-RG9ja2Vy" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-RG9ja2Vy" name="RG9ja2Vy" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>some-scylla<span class="w"> </span>supervisorctl<span class="w"> </span>restart<span class="w"> </span>scylla
</pre></div>
</div>
<p>(without restarting <em>some-scylla</em> container)</p>
</div></div>
</section>
<section id="encrypt-tables">
<h2>Encrypt Tables<a class="headerlink" href="#encrypt-tables" title="Link to this heading">¶</a></h2>
<p>ScyllaDB allows you to enable or disable default encryption of tables.
When enabled, tables will be encrypted by default using the configuration
provided for the <code class="docutils literal notranslate"><span class="pre">user_info_encryption</span></code> option in the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file.</p>
<p>You can override the default configuration when you CREATE TABLE or ALTER TABLE
with <code class="docutils literal notranslate"><span class="pre">scylla_encryption_options</span></code>. See <a class="reference internal" href="#ear-create-table"><span class="std std-ref">Encrypt a Single Table</span></a>
for details.</p>
<p><strong>Before you Begin</strong></p>
<p>Ensure you have an encryption key available:</p>
<ul>
<li><p>If you are using AWS KMS, <a class="reference internal" href="#encryption-at-rest-set-kms"><span class="std std-ref">set the KMS Host</span></a>.</p></li>
<li><p>If you are using KMIP, <a class="reference internal" href="#encryption-at-rest-set-kmip"><span class="std std-ref">set the KMIP Host</span></a>.</p></li>
<li><p>If you are using Google GCP KMS, <a class="reference internal" href="#encryption-at-rest-set-gcp"><span class="std std-ref">set the GCP Host</span></a>.</p></li>
<li><p>If you want to create your own key, follow the procedure in <a class="reference internal" href="#ear-create-encryption-key"><span class="std std-ref">Create Encryption Keys</span></a>.</p></li>
<li><p>If you do not create your own key, use the following procedure for ScyllaDB
to create a key for you (the default location <code class="docutils literal notranslate"><span class="pre">/etc/scylla/data_encryption_keys</span></code> may cause
permission issues; the following example creates a key in the directory <code class="docutils literal notranslate"><span class="pre">/etc/scylla/encryption_keys</span></code>):</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo mkdir -p /etc/scylla/encryption_keys
sudo chown -R scylla:scylla /etc/scylla/encryption_keys
sudo chmod -R 700 /etc/scylla/encryption_keys
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p><strong>Procedure</strong></p>
<p>Edit the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file located in <code class="docutils literal notranslate"><span class="pre">/etc/scylla/</span></code> and configure
the <code class="docutils literal notranslate"><span class="pre">user_info_encryption</span></code> option:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">user_info_encryption</span><span class="p">:</span>
<span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;true|false&gt;</span>
<span class="w"> </span><span class="nt">cipher_algorithm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;hashing algorithm to create the key&gt;</span>
<span class="w"> </span><span class="nt">secret_key_strength</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;length of the key&gt;</span>
<span class="w"> </span><span class="nt">key_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;your key provider&gt;</span>
<span class="w"> </span><span class="nt">secret_key_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;key file&gt;</span>
<span class="w"> </span><span class="nt">kmip_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;your kmip_host&gt;</span>
<span class="w"> </span><span class="nt">kms_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;your kms_host&gt;</span>
<span class="w"> </span><span class="nt">gcp_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;your gcp_host&gt;</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code> - Enables or disables default table encryption. Required.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cipher_algorithm</span></code> - One of the <a class="reference internal" href="#ear-cipher-algorithms"><span class="std std-ref">cipher algorithms</span></a>.
If not provided, the default will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secret_key_strength</span></code> - The length of the key in bytes ( determined by
the <a class="reference internal" href="#ear-cipher-algorithms"><span class="std std-ref">cipher algorithms</span></a> you choose).
If not provided, the default will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_provider</span></code> - The name of the key provider. See <a class="reference internal" href="#ear-key-providers"><span class="std std-ref">Key Providers</span></a>.
Required.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secret_key_file</span></code> - The location of the key created by ScyllaDB (by default <code class="docutils literal notranslate"><span class="pre">/etc/scylla/data_encryption_keys</span></code>).
Required if you use a ScyllaDB-generated key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kmip_host</span></code> - The name of your <a class="reference internal" href="#encryption-at-rest-set-kmip"><span class="std std-ref">kmip_host</span></a> group.
Required if you use KMIP.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kms_host</span></code> - The name of your <a class="reference internal" href="#encryption-at-rest-set-kms"><span class="std std-ref">kms_host</span></a> group.
Required if you use KMS.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcp_host</span></code> - The name of your <a class="reference internal" href="#encryption-at-rest-set-gcp"><span class="std std-ref">gcp_host</span></a> group.
Required if you use GCP.</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">user_info_encryption</span><span class="p">:</span>
<span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w"> </span><span class="nt">cipher_algorithm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AES</span>
<span class="w"> </span><span class="nt">secret_key_strength</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w"> </span><span class="nt">key_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LocalFileSystemKeyProviderFactory</span>
<span class="w"> </span><span class="nt">secret_key_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scylla /etc/scylla/encryption_keys</span>
</pre></div>
</div>
<p><strong>Examples for KMS:</strong></p>
<p>In the following example, the <code class="docutils literal notranslate"><span class="pre">master_key</span></code> configured for <a class="reference internal" href="#encryption-at-rest-set-kms"><span class="std std-ref">kms_host</span></a> will be used.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">user_info_encryption</span><span class="p">:</span>
<span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w"> </span><span class="nt">key_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KmsKeyProviderFactory</span>
<span class="w"> </span><span class="nt">kms_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kms1</span>
</pre></div>
</div>
<p>You can specify a different <code class="docutils literal notranslate"><span class="pre">master_key</span></code> than the one configured for <a class="reference internal" href="#encryption-at-rest-set-kms"><span class="std std-ref">kms_host</span></a>:</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">user_info_encryption</span><span class="p">:</span>
<span class="w"> </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w"> </span><span class="nt">key_provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KmsKeyProviderFactory</span>
<span class="w"> </span><span class="nt">kms_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-kms1</span>
<span class="w"> </span><span class="nt">master_key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myorg/SomeOtherKey</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="encrypt-a-single-table">
<span id="ear-create-table"></span><h2>Encrypt a Single Table<a class="headerlink" href="#encrypt-a-single-table" title="Link to this heading">¶</a></h2>
<p>This procedure demonstrates how to encrypt a new table.</p>
<p><strong>Before you Begin</strong></p>
<ul class="simple">
<li><p>Make sure to <a class="reference internal" href="#set-the-kmip-host">Set the KMIP Host</a> if you are using KMIP, or the the <a class="reference internal" href="#encryption-at-rest-set-kms"><span class="std std-ref">KMS Host</span></a> if you are using AWS KMS.</p></li>
<li><p>If you want to make your own key, use the procedure in <a class="reference internal" href="#create-encryption-keys">Create Encryption Keys</a> and skip to step 3. If you do not create your own key, ScyllaDB will create one for you in the <code class="docutils literal notranslate"><span class="pre">secret_key_file</span></code> path. If you are not creating your own key, start with step 1.</p></li>
</ul>
<p><strong>Procedure</strong></p>
<ol class="arabic">
<li><p>By default, the encryption key is located in the <code class="docutils literal notranslate"><span class="pre">/etc/scylla/</span></code> directory, and the file is named <code class="docutils literal notranslate"><span class="pre">data_encryption_keys</span></code>. If you want to save the key in a different directory, create one. This example will create encryption keys in a different directory (<code class="docutils literal notranslate"><span class="pre">/etc/scylla/encryption_keys</span></code>, for example), which ensures that the owner of this directory is <code class="docutils literal notranslate"><span class="pre">scylla</span></code> and not another user.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the default location results in a known permission issue (scylladb/scylla-tools-java#94), so it is recommended to use another location as described in the example.</p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo mkdir -p /etc/scylla/encryption_keys
sudo chown -R scylla:scylla /etc/scylla/encryption_keys
sudo chmod -R 700 /etc/scylla/encryption_keys
</pre></div>
</div>
</li>
<li><p>Create the keyspace if it doesn’t exist.</p></li>
<li><p>Create the table using the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> CQL statement, adding any <a class="reference internal" href="../../cql/ddl.html#create-table-statement"><span class="std std-ref">additional options</span></a>. To encrypt the table, use the options for encryption below, remembering to set the <code class="docutils literal notranslate"><span class="pre">secret_key_file</span> <span class="pre">&lt;path&gt;</span></code> to the same directory you created in step 1.</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">keyspace</span><span class="o">&gt;</span><span class="mf">.</span><span class="o">&lt;</span><span class="n">table_name</span><span class="o">&gt;</span> <span class="p">(</span><span class="mf">...</span><span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span><span class="mf">...</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">hash</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">len</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">provider</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_file&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cipher_algorithm</span></code> -  The hashing algorithm which is to be used to create the key. See <a class="reference internal" href="#cipher-algorithms">Cipher Algorithms</a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secret_key_strength</span></code> - The length of the key in bytes. This is determined by the cipher you choose. See <a class="reference internal" href="#cipher-algorithms">Cipher Algorithms</a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_provider</span></code> is the name or type of key provider. Refer to <a class="reference internal" href="#key-providers">Key Providers</a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secret_key_file</span></code> - the location that ScyllaDB will store the key it creates (if one does not exist in this location) or the location of the key. By default the location is <code class="docutils literal notranslate"><span class="pre">/etc/scylla/data_encryption_keys</span></code>.</p></li>
</ul>
<p><strong>Example:</strong></p>
<p>Continuing the example from above, this command will instruct ScyllaDB to encrypt the table and will save the key in the location created in step 1.</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">data</span><span class="mf">.</span><span class="n">atrest</span> <span class="p">(</span><span class="n">pk</span> <span class="nb">text</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span> <span class="n">c0</span> <span class="nb">int</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span> <span class="s1">&#39;AES/ECB/PKCS5Padding&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="mf">128</span><span class="p">,</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;LocalFileSystemKeyProviderFactory&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_file&#39;</span><span class="p">:</span> <span class="s1">&#39;/etc/scylla/encryption_keys/data_encryption_keys&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p><strong>Example for KMS:</strong></p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">myks</span><span class="mf">.</span><span class="n">mytable</span> <span class="p">(</span><span class="mf">...</span><span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span><span class="mf">...</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span>  <span class="s1">&#39;AES/CBC/PKCS5Padding&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="mf">128</span><span class="p">,</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;KmsKeyProviderFactory&#39;</span><span class="p">,</span>
    <span class="s1">&#39;kms_host&#39;</span><span class="p">:</span> <span class="s1">&#39;my-kms1&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p>You can skip <code class="docutils literal notranslate"><span class="pre">cipher_algorithm</span></code> and <code class="docutils literal notranslate"><span class="pre">secret_key_strength</span></code> (the <a class="reference internal" href="#ear-cipher-algorithms"><span class="std std-ref">defaults</span></a> will be used):</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">myks</span><span class="mf">.</span><span class="n">mytable</span> <span class="p">(</span><span class="mf">...</span><span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span><span class="mf">...</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;KmsKeyProviderFactory&#39;</span><span class="p">,</span>
    <span class="s1">&#39;kms_host&#39;</span><span class="p">:</span> <span class="s1">&#39;my-kms1&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p>You can specify a different master key than the one configured for <code class="docutils literal notranslate"><span class="pre">kms_host</span></code> in the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">myks</span><span class="mf">.</span><span class="n">mytable</span> <span class="p">(</span><span class="mf">...</span><span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span><span class="mf">...</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;KmsKeyProviderFactory&#39;</span><span class="p">,</span>
    <span class="s1">&#39;kms_host&#39;</span><span class="p">:</span> <span class="s1">&#39;my-kms1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;master_key&#39;</span><span class="p">:</span><span class="s1">&#39;myorg/SomeOtherKey&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>From this point, every new SSTable created for the <code class="docutils literal notranslate"><span class="pre">atrest</span></code> table is encrypted, using the <code class="docutils literal notranslate"><span class="pre">data_encryption_keys</span></code> key located in <code class="docutils literal notranslate"><span class="pre">/etc/scylla/encryption_keys/</span></code>. This table will remain encrypted with this key until you either change the key, change the key properties, or disable encryption.</p></li>
<li><p>To ensure all SSTables for this table on every node are encrypted, run the <a class="reference internal" href="../nodetool-commands/upgradesstables.html"><span class="doc">Nodetool upgradesstables</span></a> command. If not, the SSTables remain unencrypted until they are compacted or flushed from MemTables.</p>
<p>For Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nodetool upgradesstables data atrest
</pre></div>
</div>
</li>
<li><p>Your SSTables are encrypted. If you want to change the key at any point, use the <a class="reference internal" href="#update-encryption-properties-of-existing-tables">Update Encryption Properties of Existing Tables</a> procedure. Always keep your key in a safe location known to you. Do not lose it. See <a class="reference internal" href="#when-a-key-is-lost">When a Key is Lost</a>.</p></li>
</ol>
<section id="update-encryption-properties-of-existing-tables">
<span id="ear-alter-table"></span><h3>Update Encryption Properties of Existing Tables<a class="headerlink" href="#update-encryption-properties-of-existing-tables" title="Link to this heading">¶</a></h3>
<p>You can encrypt any existing table or use this procedure to change the cipher algorithm, key location or key strength or even disable encryption on a table.</p>
<p><strong>Procedure</strong></p>
<ol class="arabic">
<li><p>Edit the table properties to enable encryption of one table of your choosing. Use the properties explained in <a class="reference internal" href="#encrypt-a-single-table">Encrypt a Single Table</a> if needed.</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">keyspace</span><span class="o">&gt;</span><span class="mf">.</span><span class="o">&lt;</span><span class="n">table_name</span><span class="o">&gt;</span> <span class="p">(</span><span class="mf">...</span><span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span><span class="mf">...</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">hash</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">len</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">provider</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_file&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p><strong>Example:</strong></p>
<p>Continuing the example from above, this command will instruct ScyllaDB to encrypt the table and will save the key in the location created in step 1.</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">data</span><span class="mf">.</span><span class="n">atrest</span> <span class="p">(</span><span class="n">pk</span> <span class="nb">text</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span> <span class="n">c0</span> <span class="nb">int</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span> <span class="s1">&#39;AES/ECB/PKCS5Padding&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="mf">192</span><span class="p">,</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;LocalFileSystemKeyProviderFactory&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_file&#39;</span><span class="p">:</span> <span class="s1">&#39;/etc/scylla/encryption_keys/data_encryption_keys&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p><strong>Example for KMS:</strong></p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">myks</span><span class="mf">.</span><span class="n">mytable</span> <span class="p">(</span><span class="mf">...</span><span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span><span class="mf">...</span><span class="p">)</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span>  <span class="s1">&#39;AES/CBC/PKCS5Padding&#39;</span><span class="p">,</span>
    <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="mf">128</span><span class="p">,</span>
    <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;KmsKeyProviderFactory&#39;</span><span class="p">,</span>
    <span class="s1">&#39;kms_host&#39;</span><span class="p">:</span> <span class="s1">&#39;my-kms1&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>If you want to make sure that SSTables that existed before this change are also encrypted, you can either upgrade them using the <code class="docutils literal notranslate"><span class="pre">nodetool</span> <span class="pre">upgradesstables</span></code> command or wait until the next compaction. If you decide to wait, ScyllaDB will still be able to read the old unencrypted tables. If you change the key or remove encryption, ScyllaDB will still continue to read the old tables as long as you still have the key. If your data is encrypted and you do not have the key, your data is unreadable.</p>
<ul>
<li><p>If you decide to upgrade all of your old SSTables run the <a class="reference internal" href="../nodetool-commands/upgradesstables.html"><span class="doc">nodetool upgradesstables</span></a> command.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nodetool upgradesstables &lt;keyspace&gt; &lt;table&gt;
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nodetool upgradesstables ks test
</pre></div>
</div>
</li>
<li><p>Repeat this command on all nodes as nodetool runs locally.</p></li>
</ul>
</li>
<li><p>If you want to change the key or disable encryption, repeat the <a class="reference internal" href="#update-encryption-properties-of-existing-tables">Update Encryption Properties of Existing Tables</a> procedure using the examples below as reference.</p></li>
</ol>
<p><strong>Examples</strong></p>
<p>To encrypt an existing table named test in keyspace ks:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">ks</span><span class="mf">.</span><span class="n">test</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span> <span class="s1">&#39;AES/ECB/PKCS5Padding&#39;</span><span class="p">,</span>
     <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="mf">128</span><span class="p">,</span>
     <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;LocalFileSystemKeyProviderFactory&#39;</span><span class="p">,</span>
     <span class="s1">&#39;secret_key_file&#39;</span><span class="p">:</span> <span class="s1">&#39;/etc/scylla/encryption_keys/data_encryption_keys&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p>To change the cipher algorithm from AES/ECB/PKCS5Padding to AES/ECB/PKCS5Padding and to change the key strength from 128 to 192 on an existing table:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">ks</span><span class="mf">.</span><span class="n">test</span> <span class="k">WITH</span>
  <span class="n">scylla_encryption_options</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;cipher_algorithm&#39;</span> <span class="p">:</span> <span class="s1">&#39;AES/ECB/PKCS5Padding&#39;</span><span class="p">,</span>
     <span class="s1">&#39;secret_key_strength&#39;</span> <span class="p">:</span> <span class="mf">192</span><span class="p">,</span>
     <span class="s1">&#39;key_provider&#39;</span><span class="p">:</span> <span class="s1">&#39;LocalFileSystemKeyProviderFactory&#39;</span><span class="p">,</span>
     <span class="s1">&#39;secret_key_file&#39;</span><span class="p">:</span> <span class="s1">&#39;/etc/scylla/encryption_keys/data_encryption_keys&#39;</span>
  <span class="p">}</span>
<span class="p">;</span>
</pre></div>
</div>
<p>To disable encryption on an encrypted table named test in keyspace ks:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">ks</span><span class="mf">.</span><span class="n">test</span> <span class="k">WITH</span>
   <span class="n">scylla_encryption_options</span> <span class="o">=</span>  <span class="p">{</span> <span class="s1">&#39;key_provider&#39;</span> <span class="p">:</span> <span class="s1">&#39;none’ };</span>
</pre></div>
</div>
</section>
</section>
<section id="encrypt-system-resources">
<h2>Encrypt System Resources<a class="headerlink" href="#encrypt-system-resources" title="Link to this heading">¶</a></h2>
<p>System encryption is applied to semi-transient on-disk data, such as commit logs, batch logs, and hinted handoff data.
This ensures that all temporarily stored data is encrypted until fully persisted to final SSTable on disk.
Once this encryption is enabled, it is used for all system data.</p>
<p><strong>Procedure</strong></p>
<ol class="arabic">
<li><p>Edit the scylla.yaml file - located in /etc/scylla/scylla.yaml and add the following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>system_info_encryption:
   enabled: &lt;true|false&gt;
   key_provider: (optional) &lt;key provider type&gt;
   system_key_directory: &lt;path to location of system key&gt;
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">enabled</span></code> can be true or false. True is enabled; false is disabled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key_provider</span></code> is the name or type of key provider. Refer to <a class="reference internal" href="#key-providers">Key Providers</a> for more information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cipher_algorithm</span></code> is one of the supported <a class="reference internal" href="#cipher-algorithms">Cipher Algorithms</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secret_key_file</span></code> is the name of the key file containing the secret key (key.pem, for example)</p></li>
</ul>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>system_info_encryption:
   enabled: True
   cipher_algorithm: AES
   secret_key_strength: 128
   key_provider: LocalFileSystemKeyProviderFactory
   secret_key_file: /path/to/systemKey.pem
</pre></div>
</div>
<p>Example for KMIP:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>system_info_encryption:
   enabled: True
   cipher_algorithm: AES
   secret_key_strength: 128
   key_provider: KmipKeyProviderFactory
   kmip_host:  yourkmipServerIP.com
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">kmip_host</span></code> is the address for your KMIP server.</p>
<p>Example for KMS:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>system_info_encryption:
   enabled: True
   cipher_algorithm: AES/CBC/PKCS5Padding
   secret_key_strength: 128
   key_provider: KmsKeyProviderFactory
   kms_host: myScylla
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">kms_host</span></code> is the unique name of the KMS host specified in the scylla.yaml file.</p>
<p>Example for GCP:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>system_info_encryption:
   enabled: True
   cipher_algorithm: AES/CBC/PKCS5Padding
   secret_key_strength: 128
   key_provider: GcpKeyProviderFactory
   gcp_host: myScylla
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">gcp_host</span></code> is the unique name of the GCP host specified in the scylla.yaml file.</p>
</li>
<li><p>Do not close the yaml file. Change the system key directory location according to your settings.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">system_key_directory</span></code> is the location of the system key you created in <a class="reference internal" href="#create-encryption-keys">Create Encryption Keys</a>.</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>system_key_directory: /etc/scylla/encryption_keys/system_keys
</pre></div>
</div>
</li>
<li><p>Save the file.</p></li>
<li><p>Drain the node with <a class="reference internal" href="../nodetool-commands/drain.html"><span class="doc">nodetool drain</span></a></p></li>
<li><p>Restart the scylla-server service.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-U3VwcG9ydGVkIE9T" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tab" tabindex="0">Supported OS</button><button aria-controls="panel-3-RG9ja2Vy" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-RG9ja2Vy" name="RG9ja2Vy" role="tab" tabindex="-1">Docker</button></div><div aria-labelledby="tab-3-U3VwcG9ydGVkIE9T" class="sphinx-tabs-panel group-tab" id="panel-3-U3VwcG9ydGVkIE9T" name="U3VwcG9ydGVkIE9T" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>scylla-server
</pre></div>
</div>
</div><div aria-labelledby="tab-3-RG9ja2Vy" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-RG9ja2Vy" name="RG9ja2Vy" role="tabpanel" tabindex="0"><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>some-scylla<span class="w"> </span>supervisorctl<span class="w"> </span>restart<span class="w"> </span>scylla
</pre></div>
</div>
<p>(without restarting <em>some-scylla</em> container)</p>
</div></div>
</li>
</ol>
</section>
<section id="when-a-key-is-lost">
<h2>When a Key is Lost<a class="headerlink" href="#when-a-key-is-lost" title="Link to this heading">¶</a></h2>
<p>It is crucial to back up all of your encryption keys in a secure way. Keep a copy of all keys in a secure location. In the event that you do lose a key, your data encrypted with that key will be unreadable.</p>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../nodetool-commands/upgradesstables.html"><span class="doc">nodetool upgradesstables</span></a></p></li>
<li><p><a class="reference internal" href="../../cql/ddl.html#create-table-statement"><span class="std std-ref">CREATE TABLE parameters</span></a></p></li>
</ul>
</section>
</section>

                    </div>
                    
                        <div class="post-content">
                            
    <div class="feedback-container">
        <p class="feedback-container__title">Was this page helpful?</p>
        <span data-tooltip tabindex="1" title="Yes" data-position="top">
            <button class="feedback-container__button" id="feedback-positive">
                <i class="feedback-container__icon icon-docs-thumbs-up"></i>
            </button>
        </span>
        <span data-tooltip tabindex="1" title="No" data-position="top">
            <button class="feedback-container__button" id="feedback-negative">
                <i class="feedback-container__icon icon-docs-thumbs-down"></i>
            </button>
        </span>
        <div class="feedback-container__message" id="feedback-message"></div>
    </div>

    <script>
        function resetFeedbackButtonActive() {
            const feedbackButtons = document.getElementsByClassName('feedback-container__button');
            for (let i = 0; i < feedbackButtons.length; i++) {
                feedbackButtons[i].classList.remove('active');
            }
        }

        function showMessage(liked) {
            const feedbackMessage = document.getElementById('feedback-message');
            const themeGithubRepository = true;
            let message = 'Great! Thanks for your feedback.';
            if (themeGithubRepository && !liked) {
                message = "Thanks for your feedback! Please don't hesitate to <a href='https://github.com/scylladb/scylladb/issues/new?title=docs:%20Issue on page Encryption at Rest&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://opensource.docs.scylladb.com/master/operating-scylla/security/encryption-at-rest%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation'>create an issue</a> if you have any suggestions on how we can improve.";
            }
            feedbackMessage.innerHTML = message;
        }

        function sendGaEvent(liked) {
            const event_label = liked ? "positive" : "negative";
            const event = "feedback_" + event_label;
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': event,
            });
        }

        const positiveFeebackButton = document.getElementById('feedback-positive');
        const negativeFeedbackButton = document.getElementById('feedback-negative');

        positiveFeebackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(true);
            showMessage(true);
            positiveFeebackButton.classList.add('active');
        });

        negativeFeedbackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(false);
            showMessage(false);
            negativeFeedbackButton.classList.add('active');
        });
    </script>

                            <div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="saslauthd.html">
                <button class="navigation__button">
                    <i class="icon-chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Configure SaslauthdAuthenticator
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="ldap-authentication.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />LDAP Authentication
                </div>
                <button class="navigation__button">
                    <i class="icon-chevron-right"></i>
                </button>
            </a>
        
    </div>
</div>
                            <!-- Post content text -->
                        </div>
                    
                
                
                    </div>
                        <div class="sidebar-right large-order-3">
                            <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a class="button button-sm" href="https://github.com/scylladb/scylladb/issues/new?title=docs:%20Issue on page Encryption at Rest&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://opensource.docs.scylladb.com/master/operating-scylla/security/encryption-at-rest%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation"
               target="_blank">
                <i class="icon-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                <a class="button button-sm" href="https://github.com/scylladb/scylladb/edit/master/docs/operating-scylla/security/encryption-at-rest.rst"
                   target="_blank">
                    <i class="icon-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Encryption at Rest</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#about-encryption-at-rest">About Encryption at Rest</a><ul>
<li><a class="reference internal" href="#when-is-data-encrypted">When is Data Encrypted?</a></li>
<li><a class="reference internal" href="#when-is-data-decrypted">When is Data Decrypted?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#encryption-key-types">Encryption Key Types</a><ul>
<li><a class="reference internal" href="#system-keys">System Keys</a></li>
<li><a class="reference internal" href="#table-keys">Table Keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-providers">Key Providers</a><ul>
<li><a class="reference internal" href="#about-local-key-storage">About Local Key Storage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cipher-algorithms">Cipher Algorithms</a></li>
<li><a class="reference internal" href="#create-encryption-keys">Create Encryption Keys</a><ul>
<li><a class="reference internal" href="#use-the-key-generator-script">Use the key generator script</a></li>
<li><a class="reference internal" href="#copy-keys-to-nodes">Copy keys to nodes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#set-the-kmip-host">Set the KMIP Host</a></li>
<li><a class="reference internal" href="#set-the-kms-host">Set the KMS Host</a></li>
<li><a class="reference internal" href="#set-the-gcp-host">Set the GCP Host</a></li>
<li><a class="reference internal" href="#encrypt-tables">Encrypt Tables</a></li>
<li><a class="reference internal" href="#encrypt-a-single-table">Encrypt a Single Table</a><ul>
<li><a class="reference internal" href="#update-encryption-properties-of-existing-tables">Update Encryption Properties of Existing Tables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#encrypt-system-resources">Encrypt System Resources</a></li>
<li><a class="reference internal" href="#when-a-key-is-lost">When a Key is Lost</a></li>
<li><a class="reference internal" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                        </div>
                    </div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="icon-docs-menu-collapse"></i>
    </button>
    <div class="side-nav-content custom-scroll-bar">
        <div class="side-nav__title">
            <a href="../../index.html">ScyllaDB Open Source</a>
        </div>
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions"><ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
    <li class="scylla-dropdown__item">
        <a class="scylla-dropdown__title" href="#">
            
                master
            
            <i class="chevron icon-docs-chevron-right"></i>
        </a>
        <ul class="menu scylla-dropdown__content">
            
                
                    <li>
                        <a href="encryption-at-rest.html">master</a>
                    </li>
                
            
            
        </ul>
    </li>
</ul></div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../getting-started/install-scylla/index.html">Install ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install-scylla/launch-on-aws.html">Launch ScyllaDB on AWS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install-scylla/launch-on-gcp.html">Launch ScyllaDB on GCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install-scylla/launch-on-azure.html">Launch ScyllaDB on Azure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/scylla-web-installer.html">ScyllaDB Web Installer for Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install-scylla/install-on-linux.html">Install ScyllaDB Linux Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/install-jmx.html">Install scylla-jmx Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/install-scylla/run-in-docker.html">Run ScyllaDB in Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/unified-installer.html">Install ScyllaDB Without root Privileges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/air-gapped-install.html">Air-gapped Server Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/disable-housekeeping.html">ScyllaDB Housekeeping and how to disable it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/dev-mod.html">ScyllaDB Developer Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/configure.html">Configure ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/config-commands.html">ScyllaDB Configuration Reference</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../getting-started/requirements.html">ScyllaDB Requirements</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/system-requirements.html">System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/os-support.html">OS Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/cloud-instance-recommendations.html">Cloud Instance Recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/scylla-in-a-shared-environment.html">ScyllaDB in a Shared Environment</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../using-scylla/migrate-scylla.html">Migrate to ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../procedures/cassandra-to-scylla-migration-process.html">Migration Process from Cassandra to ScyllaDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/cassandra-compatibility.html">ScyllaDB and Apache Cassandra Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/mig-tool-review.html">Migration Tools Overview</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../using-scylla/integrations/index.html">Integration Solutions</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-spark.html">Integrate ScyllaDB with Spark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-kairos.html">Integrate ScyllaDB with KairosDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-presto.html">Integrate ScyllaDB with Presto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-elasticsearch.html">Integrate ScyllaDB with Elasticsearch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-k8.html">Integrate ScyllaDB with Kubernetes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-janus.html">Integrate ScyllaDB with the JanusGraph Graph Data System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-datadog.html">Integrate ScyllaDB with DataDog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-kafka.html">Integrate ScyllaDB with Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-iota.html">Integrate ScyllaDB with IOTA Chronicle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-spring.html">Integrate ScyllaDB with Spring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/sink-kafka-connector.html">Shard-Aware Kafka Connector for ScyllaDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-ansible.html">Install ScyllaDB with Ansible</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-databricks.html">Integrate ScyllaDB with Databricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-jaeger.html">Integrate ScyllaDB with Jaeger Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/integrations/integration-mindsdb.html">Integrate ScyllaDB with MindsDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/tutorials.html">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">ScyllaDB for Administrators</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../admin.html">Administration Guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../procedures/index.html">Procedures</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../procedures/cluster-management/index.html">Cluster Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedures/backup-restore/index.html">Backup &amp; Restore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedures/config-change/index.html">Change Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedures/maintenance/index.html">Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedures/tips/index.html">Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../benchmarking-scylla.html">Benchmarking ScyllaDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedures/cassandra-to-scylla-migration-process.html">Migrate from Cassandra to ScyllaDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/installation-common/disable-housekeeping.html">Disable Housekeeping</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Security</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="security-checklist.html">ScyllaDB Security Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="authentication.html">Enable Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime-authentication.html">Enable and Disable Authentication Without Downtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="create-superuser.html">Creating a Custom Superuser</a></li>
<li class="toctree-l3"><a class="reference internal" href="gen-cqlsh-file.html">Generate a cqlshrc File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/password-reset.html">Reset Authenticator Password</a></li>
<li class="toctree-l3"><a class="reference internal" href="enable-authorization.html">Enable Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="authorization.html">Grant Authorization CQL Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="certificate-authentication.html">Certificate-based Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="rbac-usecase.html">Role Based Access Control (RBAC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="auditing.html">ScyllaDB Auditing Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="client-node-encryption.html">Encryption: Data in Transit Client to Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="node-node-encryption.html">Encryption: Data in Transit Node to Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="generate-certificate.html">Generating a self-signed Certificate Chain Using openssl</a></li>
<li class="toctree-l3"><a class="reference internal" href="saslauthd.html">Configure SaslauthdAuthenticator</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Encryption at Rest</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldap-authentication.html">LDAP Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="ldap-authorization.html">LDAP Authorization (Role Management)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../admin-tools/index.html">Admin Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../nodetool.html">Nodetool Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cql/cqlsh.html">CQLSh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest.html">Admin REST API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/tracing.html">Tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/scylla-sstable.html">ScyllaDB SStable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/scylla-types.html">ScyllaDB Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/sstableloader.html">SSTableLoader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/cassandra-stress.html">cassandra-stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/sstabledump.html">SSTabledump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/sstablemetadata.html">SSTableMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/logging.html">ScyllaDB Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/perftune.html">Seastar Perftune</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/virtual-tables.html">Virtual Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/select-from-mutation-fragments.html">Reading mutation fragments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/maintenance-socket.html">Maintenance socket</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/maintenance-mode.html">Maintenance mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin-tools/task-manager.html">Task manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://monitoring.docs.scylladb.com/">ScyllaDB Monitoring Stack</a></li>
<li class="toctree-l2"><a class="reference external" href="https://operator.docs.scylladb.com/">ScyllaDB Operator</a></li>
<li class="toctree-l2"><a class="reference external" href="https://manager.docs.scylladb.com/">ScyllaDB Manager</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../upgrade/index.html">Upgrade Procedures</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade/about-upgrade.html">About Upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../upgrade/upgrade-guides/index.html">Upgrade Guides</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../system-configuration/index.html">System Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label for="toctree-checkbox-11"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started/system-configuration.html">System Configuration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin.html">scylla.yaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system-configuration/snitch.html">ScyllaDB Snitches</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarking-scylla.html">Benchmarking ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diagnostics.html">ScyllaDB Diagnostic Tools</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../using-scylla/index.html">ScyllaDB for Developers</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label for="toctree-checkbox-12"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference external" href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/index.html">Develop with ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html">Tutorials and Example Projects</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.scylladb.com/stable/get-started/learn-resources/index.html">Learn to Use ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../using-scylla/alternator/index.html">ScyllaDB Alternator</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../using-scylla/drivers/index.html">ScyllaDB Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label for="toctree-checkbox-13"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/drivers/cql-drivers/index.html">ScyllaDB CQL Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../using-scylla/drivers/dynamo-drivers/index.html">ScyllaDB DynamoDB Drivers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cql/index.html">CQL Reference</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label for="toctree-checkbox-14"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cql/cqlsh.html">CQLSh: the CQL shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/appendices.html">Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/compaction.html">Compaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/consistency.html">Consistency Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/consistency-calculator.html">Consistency Level Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/ddl.html">Data Definition</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cql/dml.html">Data Manipulation</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label for="toctree-checkbox-15"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cql/dml/select.html">SELECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cql/dml/insert.html">INSERT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cql/dml/update.html">UPDATE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cql/dml/delete.html">DELETE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cql/dml/batch.html">BATCH</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/types.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/definitions.html">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/secondary-indexes.html">Global Secondary Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/time-to-live.html">Expiring Data with Time to Live (TTL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/wasm.html">Wasm support for user-defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/json.html">JSON Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/mv.html">Materialized Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/non-reserved-keywords.html">Non-Reserved CQL Keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/reserved-keywords.html">Reserved CQL Keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/describe-schema.html">DESCRIBE SCHEMA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/service-levels.html">Service Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cql/cql-extensions.html">ScyllaDB CQL Extensions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../alternator/alternator.html">Alternator: DynamoDB API in Scylla</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label for="toctree-checkbox-16"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../alternator/getting-started.html">Getting Started With ScyllaDB Alternator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../alternator/compatibility.html">ScyllaDB Alternator for DynamoDB users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../alternator/new-apis.html">Alternator-specific APIs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../features/index.html">Features</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label for="toctree-checkbox-17"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../features/lwt.html">Lightweight Transactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/secondary-indexes.html">Global Secondary Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/local-secondary-indexes.html">Local Secondary Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/materialized-views.html">Materialized Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/counters.html">Counters</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../features/cdc/index.html">Change Data Capture</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label for="toctree-checkbox-18"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-intro.html">CDC Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-log-table.html">The CDC Log Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-basic-operations.html">Basic operations in CDC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-streams.html">CDC Streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-stream-generations.html">CDC Stream Generations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-querying-streams.html">Querying CDC Streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-advanced-types.html">Advanced column types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-preimages.html">Preimages and postimages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features/cdc/cdc-consistency.html">Data Consistency in CDC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../features/workload-attributes.html">Workload Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features/workload-prioritization.html">Workload Prioritization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../architecture/index.html">ScyllaDB Architecture</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label for="toctree-checkbox-19"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/tablets.html">Data Distribution with Tablets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/ringarchitecture/index.html">ScyllaDB Ring Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/architecture-fault-tolerance.html">ScyllaDB Fault Tolerance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/console-CL-full-demo.html">Consistency Level Console Demo</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../architecture/anti-entropy/index.html">ScyllaDB Anti-Entropy</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label for="toctree-checkbox-20"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture/anti-entropy/hinted-handoff.html">ScyllaDB Hinted Handoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture/anti-entropy/read-repair.html">ScyllaDB Read Repair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../procedures/maintenance/repair.html">ScyllaDB Repair</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../architecture/sstable/index.html">SSTable</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label for="toctree-checkbox-21"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../architecture/sstable/sstable2/index.html">ScyllaDB SSTable - 2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../architecture/sstable/sstable3/index.html">ScyllaDB SSTable - 3.x</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/compaction/compaction-strategies.html">Compaction Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/raft.html">Raft Consensus Algorithm in ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture/zero-token-nodes.html">Zero-token Nodes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label for="toctree-checkbox-22"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/support/index.html">Errors and Support</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label for="toctree-checkbox-23"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/report-scylla-problem.html">Report a ScyllaDB problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/error-messages/index.html">Error Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/log-level.html">Change Log Level</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/startup/index.html">ScyllaDB Startup</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label for="toctree-checkbox-24"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/change-ownership.html">Ownership Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/scylla-wont-start.html">ScyllaDB will not Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/python-error-no-module-named-yaml.html">ScyllaDB Python Script broken</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/upgrade/index.html">Upgrade</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label for="toctree-checkbox-25"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/missing-dotmount-files.html">Inaccessible configuration files after ScyllaDB upgrade</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/cluster/index.html">Cluster and Node</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label for="toctree-checkbox-26"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/handling-node-failures.html">Handling Node Failures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/failed-add-remove-replace.html">Failure to Add, Remove, or Replace a Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/failed-decommission.html">Failed Decommission Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/timeouts.html">Cluster Timeouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/node-joined-without-any-data.html">Node Joined With No Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/nodetool-nullpointerexception.html">NullPointerException</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/failed-schema-sync.html">Failed Schema Sync</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/modeling/index.html">Data Modeling</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label for="toctree-checkbox-27"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/large-partition-table.html">ScyllaDB Large Partitions Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/large-rows-large-cells-tables.html">ScyllaDB Large Rows and Cells Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/debugging-large-partition.html">Large Partitions Hunting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/failed-update-schema.html">Failure to Update the Schema</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/storage/index.html">Data Storage and SSTables</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label for="toctree-checkbox-28"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/space-up.html">Space Utilization Increasing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/drop-table-space-up.html">Disk Space is not Reclaimed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/sstable-corruption.html">SSTable Corruption Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/pointless-compactions.html">Pointless Compactions</a></li>
<li class="toctree-l3"><a class="reference external" href="https://monitoring.docs.scylladb.com/stable/use-monitoring/advisor/heavyCompaction.html">Limiting Compaction</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/CQL/index.html">CQL</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label for="toctree-checkbox-29"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/time-zone.html">Time Range Query Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/copy-from-failed.html">COPY FROM Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/clients-table.html">CQL Connection Table</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/monitor/index.html">ScyllaDB Monitor and Manager</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label for="toctree-checkbox-30"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/manager-monitoring-integration.html">Manager and Monitoring integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/reverse-dns-sshd.html">Manager lists healthy nodes as down</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../troubleshooting/install-remove/index.html">Installation and Removal</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label for="toctree-checkbox-31"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../../troubleshooting/autoremove-ubuntu.html">Removing ScyllaDB on Ubuntu breaks system packages</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../kb/index.html">Knowledge Base</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label for="toctree-checkbox-32"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../kb/cdc-experimental-upgrade.html">Upgrading from experimental CDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/compaction.html">Compaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/consistency.html">Consistency in ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/count-all-rows.html">Counting all rows in a table is slow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/cqlsh-more.html">CQL Query Does Not Display Entire Result Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/cqlsh-results.html">When CQLSh query returns partial results with followed by “More”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/custom-user.html">Run ScyllaDB and supporting services as a custom user:group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/customizing-cpuset.html">Customizing CPUSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/decode-stack-trace.html">Decoding Stack Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/disk-utilization.html">Snapshots and Disk Utilization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/dpdk-hardware.html">DPDK mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/flamegraph.html">Debug your database with Flame Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/garbage-collection-ics.html">Efficient Tombstone Garbage Collection in ICS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/gc-grace-seconds.html">How to Change gc_grace_seconds for a Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/gossip.html">Gossip in ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/increase-permission-cache.html">Increase Permission Cache to Avoid Non-paged Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/lwt-differences.html">How does ScyllaDB LWT Differ from Apache Cassandra ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/map-cpu.html">Map CPUs to ScyllaDB Shards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/memory-usage.html">ScyllaDB Memory Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/ntp.html">NTP Configuration for ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/perftune-modes-sync.html">Updating the Mode in perftune.yaml After a ScyllaDB Upgrade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/posix.html">POSIX networking for ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/quiz-administrators.html">ScyllaDB consistency quiz for administrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/raid-device.html">Recreate RAID devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/rf-increase.html">How to Safely Increase the Replication Factor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/scylla-and-spark-integration.html">ScyllaDB and Spark integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/scylla-limits-systemd.html">Increase ScyllaDB resource limits over systemd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/seed-nodes.html">ScyllaDB Seed Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/set-up-swap.html">How to Set up a Swap Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/snapshots.html">ScyllaDB Snapshots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/static-columns.html">ScyllaDB payload sent duplicated static columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/stop-local-repair.html">Stopping a local repair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/system-limits.html">System Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/tombstones-flush.html">How to flush old tombstones from a table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/ttl-facts.html">Time to Live (TTL) and Compaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/unresponsive-nodes.html">ScyllaDB Nodes are Unresponsive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/update-pk.html">Update a Primary Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/use-perf.html">Using the perf utility with ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kb/yaml-address.html">Configure ScyllaDB Networking with Multiple NIC/IP Combinations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label for="toctree-checkbox-33"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/aws-images.html">AWS Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/azure-images.html">Azure Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/gcp-images.html">GCP Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/configuration-parameters.html">Configuration Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/limits.html">Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/api-reference.html">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/metrics.html">Metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">ScyllaDB FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contribute to ScyllaDB</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com"></a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/" target="_blank">Docs</a>
                <a class="footer-links__link" href="https://university.scylladb.com/" target="_blank">University</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/"
                    target="_blank">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/" target="_blank">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <i class="icon-slack"></i>
                    </span>
                </a>
                <a class="footer-actions__link" href="https://forum.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="Community forum" data-position="bottom">
                        <i class="icon-docs-community"></i>
                    </span>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            
                <div class="footer-bottom__copyright">
                    
                        
                            &#169; 2025, ScyllaDB. All rights reserved.
                        
                    
                </div>
            
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 28 Mar 2025.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a href="http://sphinx-doc.org/">Sphinx 7.4.7</a> &amp;
                <a href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.8.5</a>
            </div>
        </div>
    </div>
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                    style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>